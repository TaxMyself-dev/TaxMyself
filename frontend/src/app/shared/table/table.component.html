<!-- <table *ngIf="data" class="receipt-wrapper">
  <div *ngFor="let field of data | keyvalue">
    <tr>
      <th>
        {{getFieldValue(field.key)}}
      </th>
      <td>
        <ng-container *ngIf="field.key === 'file'; else defaultField">
          <ion-button (click)="previewFile(field.value)">הצג</ion-button>
          <ion-button (click)="downloadFile(field.value)">הורד</ion-button>
        </ng-container>
        <ng-template #defaultField>{{ field.value }}</ng-template>
      </td>
    </tr>
  </div>
  <ion-button (click)="updateExpense()">ערוך</ion-button>
  <ion-button (click)="deleteExpense()">מחק</ion-button>
</table> -->

<div class="grid-container">
  <ion-grid class="grid">
    <ion-row class="table-headers">
      <ion-col *ngIf="displayCheckbox" [size]="columnsWidth?.get('checkbox') ?? baseSize" class="col-header action">
      בחר
      </ion-col>
      <ion-col
        *ngFor="let col of fieldsNames"
        [size]="columnsWidth?.get(col.name) ?? baseSize"
        class="col-header {{col.name}}">
        {{col.value}}
      </ion-col>
      <!-- <ion-button *ngIf="!disableCheckbox" (click)="selectAll(rows)" class="checkbox-header">{{checkboxData.columnName}}</ion-button> -->
      <!-- <ion-button class="checkbox-header"><ion-col *ngIf="!disableCheckbox" size="0.5" class="checkbox-header" >{{checkboxData.columnName}}</ion-col></ion-button> -->
      <ion-col *ngIf="actions?.length" [size]="columnsWidth?.get('actions') ?? 2" class="col-header action">
        פעולות
      </ion-col>
    </ion-row>
    <ion-row *ngFor="let row of rows; let i = index" class="table-row">
      <ion-col class="checkbox-col" *ngIf="displayCheckbox" [size]="columnsWidth?.get('checkbox') ?? baseSize">
        <ion-checkbox [checked]="showChecked(row)" (ionChange)="onChecked($event, row)"></ion-checkbox>
      </ion-col>
      <ng-container *ngFor="let field of row | keyvalue: columnsOrderByFunc">
        <ng-container [ngSwitch]="specialColumnsCellRendering?.get(field.key)">
          
          <ng-container *ngSwitchCase="ICellRenderer.BILL">
            <ng-container *ngTemplateOutlet="billRenderCell"></ng-container>
          </ng-container>
          <ng-container *ngSwitchCase="ICellRenderer.CATEGORY">
            <ng-container *ngTemplateOutlet="categoryRenderCell"></ng-container>
          </ng-container>
          <ng-container *ngSwitchCase="ICellRenderer.DATE">
            <ng-container *ngTemplateOutlet="dateRenderCell"></ng-container>
          </ng-container>
          <ng-container *ngSwitchDefault>
            <ng-container *ngTemplateOutlet="defaultCell"></ng-container>
          </ng-container>
        </ng-container>

        <ng-template #defaultCell>
          <ion-col
          class="text-cell" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{ field.value }}"
                *ngIf="!columnsToIgnore.includes(field.key)"
                [size]="columnsWidth?.get(field.key) ?? baseSize">
                {{field.value}}
          </ion-col>
        </ng-template>

        <ng-template #defaultCellWithIcon>
          <ion-col 
          class="text-cell ion-col-with-icon" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{ field.value }}"
                [size]="columnsWidth?.get(field.key) ?? baseSize">
                {{field.value}}
                <div class="wrap-button-category">
                  <app-button  [buttonSize]="buttonSize.X_SMALL" [title]="iconToolTip" (onButtonClicked)="openAddTransaction(row)" [iconSrc]="iconSrc" [buttonClass]="ButtonClass.CLEAR_ICON_ONLY"></app-button>
                </div>
          </ion-col>
        </ng-template>
        
        <ng-template #billRenderCell>
          <ng-container *ngIf="field.value === 'זמני'; else defaultCell">
          <ion-col
          class="text-cell" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{ field.value }}"
          *ngIf="field.value === 'זמני'; else defaultCell"
                class="special-cell"
                [size]="field.key == 'dateTimestamp' ? 1.5 : columnsWidth?.get(field.key) ?? baseSize" 
                (click)="openAddBill(row)">
               <span class="text-special-cell">שייך לחשבון</span> 
          </ion-col>
        </ng-container>
        </ng-template>
        
        <ng-template #categoryRenderCell>
          <ion-col
          class="text-cell" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{ field.value }}"
          *ngIf="field.value === 'טרם סווג'; else defaultCellWithIcon"
                class="special-cell"
                [size]="columnsWidth?.get(field.key) ?? baseSize"
                (click)="openAddTransaction(row)">
                <span class="text-special-cell">טרם סווג</span>
          </ion-col>
        </ng-template>

        <!-- <ng-template #dateRenderCell>
          <ion-col
          class="text-cell" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{+field.value*1000 | date:'dd/MM/yyyy'}}"
                *ngIf="!columnsToIgnore.includes(field.key)"
                [class.even-row]="i % 2 === 0" [class.odd-row]="i % 2 !== 0"
                [size]="columnsWidth?.get(field.key) ?? baseSize">
                {{+field.value*1000 | date:'dd/MM/yyyy'}}
          </ion-col>
        </ng-template> -->

        <ng-template #dateRenderCell>
          <ion-col
          class="text-cell" [class.expanded]="isExpanded" (click)="toggleExpand()" title="{{field.value}}"
                *ngIf="!columnsToIgnore.includes(field.key)"
                [size]="columnsWidth?.get(field.key) ?? baseSize">
                {{field.value}}
          </ion-col>
        </ng-template>

      </ng-container>
      <!-- <ng-container  *ngIf="!displayCheckbox"> -->
      <!-- <div class="checkbox">
        <ion-checkbox [checked]="isSelected" (ionChange)="onCheckedClicked({$event,row})"></ion-checkbox>
      </div> -->
        <!-- </ng-container> -->

      <ion-col class="text-cell" *ngIf="actions?.length" [size]="columnsWidth?.get('actions') ?? 2">
        <ng-container *ngFor="let action of actions" >
          <ion-icon *ngIf="action.name !== 'upload'"  class="icon-table" (click)="action.action(row)" [name]="action.icon"></ion-icon>
          <label *ngIf="action.name === 'upload'" class="label-file-table">
            <ion-icon [name]="row[action.fieldName] ? 'document-attach-outline' : 'attach-outline'" [title]="row[action.fieldName] ?? ''"></ion-icon>
            <!-- <label></label> -->
            <ion-input  (change)="action.action($event, row)" label-placement="floating" type="file" accept=".pdf, .jpg, .jpeg, .png">
            </ion-input>
          </label>
          <!-- <ion-icon [title]="'מחק קובץ'" class="trash-icon" size="small" *ngIf="row[action.fieldName]"name="close-circle-outline"></ion-icon> -->
        </ng-container>
      </ion-col>
    </ion-row>
  </ion-grid>
</div>