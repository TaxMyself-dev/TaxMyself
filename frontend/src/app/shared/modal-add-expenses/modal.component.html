<!-- <ion-modal class="modal-content"> -->
<ion-toolbar>
  <ion-header class="add-expense-header">
    <ion-list class="header-list">
      <ion-title>
        {{title}}
      </ion-title>
      <ion-icon class="add-expense-icon-header" (click)="cancel()" aria-label="back" size="large"
        name="close-outline"></ion-icon>
    </ion-list>
  </ion-header>
</ion-toolbar>

<ion-content>
  <form *ngIf="addExpenseForm; else loader" class="form-expense" [formGroup]="addExpenseForm" scrollY="true">
    <div class="modal-content">
      <div class="wrap-supplier-list">
        <div class="wrap-select-supplier">
          <div class="supplier-text">לרשימת הספקים</div>
          <div class="select-supplier-button">
            <app-button (onButtonClicked)="openSelectSupplier()" [buttonSize]="ButtonSize.X_SMALL" [iconName]="'arrow-forward-outline'"
            [buttonClass]="ButtonClass.CLEAR_ICON_ONLY"></app-button>
          </div>
        </div>
        <ion-list class="list-expense">
          <ng-container *ngFor="let col of columns">
            <ng-container [ngSwitch]="col.type">
              <ng-container *ngSwitchCase="formTypes.TEXT">
                <!-- <ion-input [class.sum]="col.name === 'sum'" [class.expenseNumber]="col.name === 'expenseNumber'"
                [class.supplier]="col.name === 'supplier'" [class.note]="col.name === 'note'"
                [class.reductionPercent]="col.name === 'reductionPercent'"
                [class.vatPercent]="col.name === 'vatPercent'" [class.taxPercent]="col.name === 'taxPercent'"
                [class.supplierID]="col.name === 'supplierID'" class="input-expense text" label-placement="floating"
                [formControlName]="col.name" type="text" fill="outline" label="{{col.value}}"></ion-input> -->
                <!-- <div *ngIf="col.name === 'supplier'"  class="wrap-add-expense-supplier"> -->
                <app-generic-input [class]="col.name !== 'note' ? 'modal-input-text' : 'modal-input-note' " [className]="col.name === 'note' ? 'note' : 'narrow'"  [inputLabel]="col.value" 
                  [controlName]="col.name" [parentForm]="addExpenseForm"></app-generic-input>
                <!-- <span  class="supplier-span" (click)="openSelectSupplier($event)"
                *ngIf="col.name === 'supplier'">לרשימת הספקים<ion-icon name="arrow-forward-outline"></ion-icon></span> -->

                <!-- </div> -->
              </ng-container>
              <ng-container *ngSwitchCase="formTypes.DATE">
                <app-generic-input class="modal-input-date" className="narrow" [inputType]="formTypes.DATE" [inputLabel]="col.value"
                  [controlName]="col.name" [parentForm]="addExpenseForm"></app-generic-input>
              </ng-container>
              <ng-container *ngSwitchCase="formTypes.DDL">
                <ion-select required="true" [class.isEquipment]="col.name === 'isEquipment'"
                  [class.category]="col.name === 'category'" [class.subCategory]="col.name === 'subCategory'"
                  class="input-expense ddl" fill="outline" label="{{col.value}}" [formControlName]="col.name"
                  (ionChange)="onDdlSelectionChange($event, col)" label-placement="floating" interface="popover">
                  <ion-select-option *ngFor="let option of getListOptionsByKey(col.name)"
                    [value]="option.value">{{option.key}}</ion-select-option>
                </ion-select>
              </ng-container>
            </ng-container>
          </ng-container>
        </ion-list>
      </div>
      <label *ngIf="fileItem" class="label-file-add-expense">
        <div class="div-wrap">
          <ng-container *ngIf="(selectedFile || editModeFile || pdfLoaded); else notFile">
            <div *ngIf="!pdfLoaded" class="file-container">
              <ng-container *ngIf="displayFile() && !(displayFile() == 'loading'); else loader">
                <img class="image-file" [src]="displayFile()" alt="file" />
              </ng-container>
            </div>
            <ng-container *ngIf="getPdfData(); else loader">
              <object *ngIf="pdfLoaded" type="application/pdf" width="100%" height="100%" style="min-height: 500px;"
                [data]="getPdfData()">
              </object>
            </ng-container>
          </ng-container>
          <ng-template #notFile>
            <p class="text-file-type">ניתן להעלות קבצי pdf / png / jpeg בלבד</p>
            <div class="div-icon" *ngIf="!selectedFile && !editModeFile">
              <ion-icon size="large" name="document-outline"></ion-icon>
            </div>
          </ng-template>
          <p *ngIf="isEditMode && !editModeFile">לא נשמר קובץ עבור הוצאה זאת</p>
          <div class="wrap-del-change-file">
            <p><b>{{((isEditMode && !editModeFile) || selectedFile || pdfLoaded ) ? "שנה קובץ" : "בחר קובץ"}}</b></p>
            <p *ngIf="selectedFile || editModeFile" (click)="deleteFile($event)">מחק קובץ</p>
          </div>
        </div>
        <ion-input (change)="fileSelected($event)" label-placement="floating" type="file"
          accept=".pdf, .png, .jpeg, .jpg">
        </ion-input>
        <!-- <app-generic-input *ngIf="fileItem" [inputType]="formTypes.FILE" [controlName]="fileItem.name" accept=".pdf, .png, .jpeg, .jpg" [parentForm]="addExpenseForm" (onInputChange)="fileSelected($event)"></app-generic-input> -->
      </label>
    </div>

    <!-- <ng-container *ngTemplateOutlet="customFooterTemplate"></ng-container> -->

    <ng-container *ngFor="let button of buttons">
      <app-button [buttonSize]="button.size" [buttonText]="button.text" [disabled]="button.disabled"
        (onButtonClicked)="button.action()"></app-button>
    </ng-container>

    <div class="wrapp-btn-expense">
      <app-button [buttonSize]="ButtonSize.SMALL" [buttonText]="buttonText" [disabled]="disableSave()"
        (onButtonClicked)="confirm()"></app-button>
      <app-button buttonText="שמירת ספק קבוע" [buttonSize]="ButtonSize.SMALL" [disabled]="disabledAddSupplier()"
        (onButtonClicked)="addSupplier()"></app-button>
    </div>
  </form>
</ion-content>
<!-- </ion-modal> -->


<ng-template #loader>
  <ion-spinner></ion-spinner>
</ng-template>

<ng-template #lineLoader>
  <ion-loading></ion-loading>
</ng-template>

<ion-popover [isOpen]="isOpen">
  <ng-template>
    <ion-content>
      <div class="wrap-message">
        <div>{{errorString}}</div>
        <div class="wrap-buttons-message">
          <app-button [buttonSize]="ButtonSize.SMALL" buttonText="OK" (onButtonClicked)="closePop()"></app-button>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-popover>

<ion-toast [isOpen]="isToastOpen" message="ספק נשמר בהצלחה" [duration]="3000" (didDismiss)="setOpenToast()"></ion-toast>

<!-- </div> -->