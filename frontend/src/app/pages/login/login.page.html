<div class="custom-modal-backdrop" (click)="closeModal()" *ngIf="showModal">
  <div class="custom-modal" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="closeModal()">×</button>

    <div>
      ✨ <strong>ההרשמה הסתיימה בהצלחה!✨</strong><br>
      נותר רק צעד קטן אחרון – אישור המייל 🎉<br><br>

      שלחנו אליך הודעת אימות לכתובת המייל שאיתה נרשמת.<br>
      כדי להתחיל, פשוט פתח/י את ההודעה ולחץ/י על הקישור לאישור.<br><br>

      <strong>לא רואה את ההודעה?</strong><br>
      כדאי לבדוק גם בתיקיית הספאם.<br>
      ואם צריך – אפשר
      <span (click)="sendVerficaitonEmail()" class="blue-link">ללחוץ כאן למשלוח נוסף</span>.
    </div>
  </div>
</div>

<div class="login-page">
  <div class="login-section">
    <div class="login-top">
      <div class="login-logo">
        <img class="top-nav-logo" src="../../../assets/login_logo.svg" alt="Logo" height="40">
      </div>
      <div class="login-content">
        <div class="wellcome-and-socisal-buttons">
          <div class="welcome-wrapper">
            <p class="welcome-title">ברוכים הבאים</p>
            <p class="welcome-text">בחרו איך תרצו ליצור חשבון או התחברו עם החשבון הקיים שלכם</p>
          </div>

          <div class="social-login-buttons">
            <app-p-button [buttonText]="'התחברו עם פייסבוק'" [buttonSize]="buttonSize.BETWEEN"
              [buttonColor]="buttonColor.WHITE_BORDER" [buttonSize]="buttonSize.AUTO" icon="pi pi-facebook"
              iconPosition="right"></app-p-button>
            <app-p-button [buttonText]="'התחברו עם גוגל'" [buttonSize]="buttonSize.BETWEEN"
              [buttonColor]="buttonColor.WHITE_BORDER" [buttonSize]="buttonSize.AUTO" icon="pi pi-google"
              iconPosition="right"></app-p-button>
          </div>
        </div>
      </div>
    </div>

    <div class="login-center">
      <div class="wrap-register-with-exist-account">
        <div class="register-with-exist-account">
          <div class="line-with-text">
            <hr class="line" />
            <p class="text">התחברות עם חשבון קיים</p>
            <hr class="line" />
          </div>
          <form class="login-form" [formGroup]="loginForm" (ngSubmit)="login()">
            <div class="inputs-wrap">
              <p-iconfield iconPosition="right">
                <p-inputicon styleClass="pi pi-envelope" />
                <input class="input-field" type="text" pInputText pSize="large" placeholder="אימייל"
                  formControlName="userName" />
              </p-iconfield>

              <p-iconfield iconPosition="right">
                <p-inputicon styleClass="pi pi-lock" />
                <input class="input-field" pInputText [type]="showPassword ? 'text' : 'password'"
                  formControlName="password" placeholder="סיסמה" />
                <p-inputicon [styleClass]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'" (click)="togglePassword()"
                  style="cursor: pointer;"></p-inputicon>
              </p-iconfield>
            </div>
            <div class="error-slot">
              @switch (authService.error()) {
              @case ('email') {
              <p class="text-error">
                נשלח אליך בהרשמה מייל לאימות, אנא ודא שאישרת אותו<br>
                לחץ <span (click)="sendVerficaitonEmail()" class="blue-link">כאן</span>
                לשליחת מייל חדש לאימות
              </p>
              }
              @case ('user') {
              <p class="text-error">מייל או סיסמא לא תקינים.</p>
              }
              @case ('error') {
              <p class="text-error">השירות אינו זמין כעת אנא נסה מאוחר יותר</p>
              }
              @default {
              <p class="text-error">&nbsp;</p>
              }
              }
            </div>

            <div class="forgot-password">
              <span>שכחת את הסיסמה?</span>
              <app-p-button [class]="'login'" [buttonText]="'שחזור סיסמה'" [variant]="'text'" [severity]="'info'"
                [buttonSize]="buttonSize.AUTO" (onButtonClicked)="resetPassword()"
                [isLoading]="isLoadingStateResetPassword()"></app-p-button>
            </div>

            <app-p-button [buttonText]="'היכנסו עכשיו!'" [buttonSize]="buttonSize.BETWEEN"
              [buttonColor]="buttonColor.YELLOW" [disabled]="loginForm.invalid" [buttonSize]="buttonSize.BIG"
              (onButtonClicked)="login()" [isLoading]="isLoading()"></app-p-button>

          </form>
        </div>
      </div>
    </div>

    <div class="login-bottom">
      <div class="register-link">
        <span>אין לכם חשבון?</span><br />
        <app-p-button [class]="'login'" [buttonText]="'הירשמו בקלות'" [variant]="'text'" [severity]="'info'"
          [buttonSize]="buttonSize.AUTO" (onButtonClicked)="navigateToRegister()"></app-p-button>
      </div>
    </div>



  </div>

  <aside class="login-media" aria-hidden="true">
    <div class="login-media__text">
      <p class="image-title">מהיום קל יותר לעקוב אחרי ההוצאות המשותפות!</p>
    </div>
    <img class="login-media__img login-media__bg" src="../../../assets/login_bg.svg" alt="" />

    <img class="login-media__img login-media__el" src="../../../assets/login_el.svg" alt="" />
  </aside>
</div>