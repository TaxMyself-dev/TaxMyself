<app-custom-toolbar></app-custom-toolbar>



<ion-content [fullscreen]="true">
  <div class="wrap-screen">
    <app-search-bar class="generic-searchbar-wrapper" (onSearchClick)="onSubmit()" [customTemplate]="pnlReportTemplate"
      [isDisabled]="pnlReportForm.invalid">
    </app-search-bar>

    <ng-container *ngIf="!pnlReport">
      <p class="text-before-report">
        אנא בחר חודשי דיווח ומלא הכנסות על מנת ליצור דו"ח
      </p>
    </ng-container>

    <ng-container *ngIf="pnlReport">
      <ion-title> - דו"ח רווח והפסד {{userData.businessName}}</ion-title>
      <ion-title>בדיקה</ion-title>
      <ion-title>{{endDate}} - {{startDate}}</ion-title>
      <div class="wrap-output-report">
        <p class="report-title">נתוני דו"ח רווח והפסד</p>
        <!-- Display Income -->
        <div class="output-pnl-report">
          <div class="field-report">סך הכל הכנסות לפני מע"מ:</div>
          <!-- <div class="value-field-report">{{ pnlReport.income | number }}</div> -->
          <ion-input [value]="pnlReport.income | number" (ionInput)="updateIncome($event)"></ion-input>
        </div>
        <!-- Dynamically Display Expenses -->
        <ng-container *ngFor="let category of pnlReport.expenses">
          <div class="output-pnl-report">
            <div class="field-report">{{ category.category }}:</div>
            <div class="value-field-report">{{ category.total | number }}</div>
          </div>
        </ng-container>
        <!-- Display Net Profit Before Tax -->
        <div class="output-pnl-report">
          <div class="field-report">רווח נקי לפני מס:</div>
          <div class="value-field-report">{{ pnlReport.netProfitBeforeTax | number }}</div>
        </div>
      </div>
    </ng-container>
  </div>

</ion-content>

<ng-template #pnlReportTemplate>
  <form class="generic-search-bar-content" [formGroup]="pnlReportForm">
    <app-select-report-period [parentForm]="pnlReportForm"></app-select-report-period>
    <app-select-month [parentForm]="pnlReportForm"></app-select-month>
    <app-select-year [parentForm]="pnlReportForm"></app-select-year>
    <!-- <app-generic-input [controlName]="'taxableTurnover'" [inputLabel]="'הכנסה חייבת'"
      [parentForm]="pnlReportForm"></app-generic-input> -->
  </form>
</ng-template>

<ion-toast [isOpen]="isToastOpen" [message]="messageToast" [duration]="4000" (didDismiss)="setCloseToast()"></ion-toast>
