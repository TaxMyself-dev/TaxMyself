"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7023],{7023:(H,w,a)=>{a.r(w),a.d(w,{MyStoragePageModule:()=>I});var p=a(4755),h=a(5030),c=a(650),y=a(9931),v=a(3144),P=a(8505),f=a(8996),u=a(262),d=a(515),x=a(3900),O=a(8746),D=a(2408),S=a(2340),e=a(2223),_=a(421),k=a(2411),b=a(7054),E=a(7051),A=a(9868),Z=a(6742);function N(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"ion-content")(1,"div",6)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",7)(5,"app-button",8),e.NdJ("onButtonClicked",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteExpense())}),e.qZA(),e.TgZ(6,"app-button",9),e.NdJ("onButtonClicked",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelDel())}),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.message),e.xp6(2),e.Q6J("buttonSize",t.ButtonSize.SMALL),e.xp6(1),e.Q6J("buttonSize",t.ButtonSize.SMALL)}}function F(n,l){if(1&n&&(e.TgZ(0,"ion-col",10),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.ekj("totalVatPayable","totalVatPayable"===t.name)("totalTaxPayable","totalTaxPayable"===t.name)("taxPercent","taxPercent"===t.name)("vatPercent","vatPercent"===t.name)("subCategory","subCategory"===t.name)("category","category"===t.name)("date","date"===t.name)("sum","sum"===t.name)("supplier","supplier"===t.name),e.Q6J("size","date"==t.name?1.5:"supplier"==t.name||"category"==t.name?1.2:"subCategory"==t.name?1.1:1),e.xp6(1),e.hij(" ",t.value," ")}}function J(n,l){if(1&n&&(e.TgZ(0,"ion-col",19),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("size","dateTimestamp"==t.key?1.5:"supplier"==t.key||"category"==t.key?1.2:"subCategory"==t.key?1.1:1),e.xp6(1),e.hij(" ",t.value," ")}}function B(n,l){if(1&n&&(e.ynx(0),e.YNc(1,J,2,2,"ion-col",18),e.BQk()),2&n){const t=l.$implicit;e.xp6(1),e.Q6J("ngIf","id"!=t.key)}}function j(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"ion-row"),e.YNc(1,B,2,1,"ng-container",11),e.ALo(2,"keyvalue"),e.TgZ(3,"ion-col",12)(4,"ion-icon",13),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.confirmDel(s))}),e.qZA(),e._UZ(5,"ion-icon",14),e.TgZ(6,"ion-icon",15),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.previewFile(s))}),e.qZA(),e.TgZ(7,"ion-icon",16),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.updateExpense(s))}),e.qZA(),e.TgZ(8,"ion-icon",17),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.downloadFile(s))}),e.qZA()()()}if(2&n){const t=l.$implicit,o=l.index,i=e.oxw();e.ekj("even-row",o%2==0)("odd-row",o%2!=0),e.xp6(1),e.Q6J("ngForOf",e.xi3(2,5,t,i.orderByFunc))}}let z=(()=>{class n{set rows(t){this.tableRows=[],this.originalRows=t,t.forEach(o=>{const{reductionDone:i,reductionPercent:s,expenseNumber:r,file:g,isEquipment:Q,loadingDate:T,note:m,supplierID:C,userId:V,...M}=o;M.dateTimestamp="24-01-2023",this.tableRows.push(M)})}get rows(){return this.tableRows}constructor(t,o){this.filesService=t,this.expenseDataService=o,this.updateClicked=new e.vpe,this.deleteClicked=new e.vpe,this.ButtonSize=E.q,this.isOpen=!1,this.message="\u05d4\u05d0\u05dd \u05d0\u05ea\u05d4 \u05d1\u05d8\u05d5\u05d7 \u05e9\u05d1\u05e8\u05e6\u05d5\u05e0\u05da \u05dc\u05de\u05d7\u05d5\u05e7 \u05d4\u05d5\u05e6\u05d0\u05d4 \u05d6\u05d5?",this.size=1}previewFile(t){const i=this.originalRows.find(s=>s.id===t.id).file;void 0===i||""===i||null===i?alert("\u05dc\u05d0 \u05e0\u05e9\u05de\u05e8 \u05e7\u05d5\u05d1\u05e5 \u05e2\u05d1\u05d5\u05e8 \u05d4\u05d5\u05e6\u05d0\u05d4 \u05d6\u05d5"):(0,f.D)(this.filesService.downloadFile(i)).pipe((0,u.K)(s=>(console.log("err in try to open file: ",s),alert("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05e4\u05ea\u05d5\u05d7 \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5"),d.E))).subscribe(s=>{window.open(s.file,"_blank")})}deleteExpense(){console.log("event in table",this.id),this.deleteClicked.emit(this.id),this.isOpen=!1}updateExpense(t){console.log(t),console.log(this.originalRows);const o=this.originalRows.find(i=>i.id===t.id);console.log("after find",o),this.updateClicked.emit(o)}downloadFile(t){console.log("in download");const i=this.originalRows.find(s=>s.id===t.id).file;if(void 0===i||""===i||null===i)alert("\u05dc\u05d0 \u05e0\u05e9\u05de\u05e8 \u05e7\u05d5\u05d1\u05e5 \u05e2\u05d1\u05d5\u05e8 \u05d4\u05d5\u05e6\u05d0\u05d4 \u05d6\u05d5");else{const s=(0,b.cF)();(0,b.Jt)((0,b.iH)(s,i)).then(r=>{console.log("'url: ",r);const g=new XMLHttpRequest;g.responseType="blob",g.onload=Q=>{const T=new Blob([g.response],{type:"image/jpg"}),m=document.createElement("a");m.style="display: none",document.body.appendChild(m);const C=window.URL.createObjectURL(T);m.href=C,m.download=i,m.click(),window.URL.revokeObjectURL(C)},g.open("GET",r),g.send()}).catch(r=>{console.log("dhgsedgsdf",r),alert("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d4\u05d5\u05e8\u05d9\u05d3 \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5")})}}orderByFunc(t,o){const i=["supplier","dateTimestamp","sum","category","subCategory","vatPercent","taxPercent","totalTax","totalVat"],s=i.indexOf(t.key),r=i.indexOf(o.key);return-1===s&&-1!==r?1:-1!==s&&-1===r?-1:-1===s&&-1===r?0:s<r?-1:s>r?1:0}confirmDel(t){console.log("event in confirm ",t),this.id=+t.id,this.isOpen=!0}cancelDel(){this.isOpen=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(A.n),e.Y36(_.O))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-table"]],inputs:{fieldsNames:"fieldsNames",rows:"rows"},outputs:{updateClicked:"updateClicked",deleteClicked:"deleteClicked"},decls:9,vars:3,consts:[[3,"isOpen"],[1,"grid-container"],[1,"grid"],["class","row-header",3,"size","totalVatPayable","totalTaxPayable","taxPercent","vatPercent","subCategory","category","date","sum","supplier",4,"ngFor","ngForOf"],["size","2",1,"row-header","action"],[3,"even-row","odd-row",4,"ngFor","ngForOf"],[1,"wrap-message"],[1,"wrap-buttons-message"],["buttonText","\u05db\u05df",3,"buttonSize","onButtonClicked"],["buttonText","\u05dc\u05d0",3,"buttonSize","onButtonClicked"],[1,"row-header",3,"size"],[4,"ngFor","ngForOf"],["size","2"],["name","trash-outline",1,"icon-table",3,"click"],["name","share-social-outline",1,"icon-table"],["name","glasses-outline",1,"icon-table",3,"click"],["name","create-outline",1,"icon-table",3,"click"],["name","cloud-download-outline",1,"icon-table",3,"click"],[3,"size",4,"ngIf"],[3,"size"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-popover",0),e.YNc(1,N,7,3,"ng-template"),e.qZA(),e.TgZ(2,"div",1)(3,"ion-grid",2)(4,"ion-row"),e.YNc(5,F,2,20,"ion-col",3),e.TgZ(6,"ion-col",4),e._uU(7," \u05e4\u05e2\u05d5\u05dc\u05d5\u05ea "),e.qZA()(),e.YNc(8,j,9,8,"ion-row",5),e.qZA()()),2&t&&(e.Q6J("isOpen",o.isOpen),e.xp6(5),e.Q6J("ngForOf",o.fieldsNames),e.xp6(3),e.Q6J("ngForOf",o.rows))},dependencies:[p.sg,p.O5,c.wI,c.W2,c.jY,c.gu,c.Nd,c.d8,Z.r,p.Nd],styles:["ion-col[_ngcontent-%COMP%]{border:solid 1px #fff;color:#000;text-align:center}.grid-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.grid[_ngcontent-%COMP%]{width:1300px;border:2px solid rgb(79,171,79);border-radius:15px;margin:10px;padding:10px}.row-header[_ngcontent-%COMP%]{background-color:#000f0054;text-align:center}.even-row[_ngcontent-%COMP%]{background-color:#000f0021}.odd-row[_ngcontent-%COMP%]{background-color:#000f0054}.icon-table[_ngcontent-%COMP%]{cursor:pointer;width:25px;height:25px;margin:5px}.wrap-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;border-radius:15px;text-align:center}.wrap-buttons-message[_ngcontent-%COMP%]{width:70%;display:flex;justify-content:space-between}"]}),n})();var R=a(1135);let U=(()=>{class n{constructor(){this.doubleMonths=[{name:"\u05d9\u05e0\u05d5\u05d0\u05e8 - \u05e4\u05d1\u05e8\u05d5\u05d0\u05e8",value:[1,2]},{name:"\u05de\u05e8\u05e5 - \u05d0\u05e4\u05e8\u05d9\u05dc",value:[3,4]},{name:"\u05de\u05d0\u05d9 - \u05d9\u05d5\u05e0\u05d9",value:[5,6]},{name:"\u05d9\u05d5\u05dc\u05d9 - \u05d0\u05d5\u05d2\u05d5\u05e1\u05d8",value:[7,8]},{name:"\u05e1\u05e4\u05d8\u05de\u05d1\u05e8 - \u05d0\u05d5\u05e7\u05d8\u05d5\u05d1\u05e8",value:[9,10]},{name:"\u05e0\u05d5\u05d1\u05de\u05d1\u05e8 - \u05d3\u05e6\u05de\u05d1\u05e8",value:[11,12]}],this.singleMonths=[{name:"\u05d9\u05e0\u05d5\u05d0\u05e8",value:[1]},{name:"\u05e4\u05d1\u05e8\u05d5\u05d0\u05e8",value:[2]},{name:"\u05de\u05e8\u05e5",value:[3]},{name:"\u05d0\u05e4\u05e8\u05d9\u05dc",value:[4]},{name:"\u05de\u05d0\u05d9",value:[5]},{name:"\u05d9\u05d5\u05e0\u05d9",value:[6]},{name:"\u05d9\u05d5\u05dc\u05d9",value:[7]},{name:"\u05d0\u05d5\u05d2\u05d5\u05e1\u05d8",value:[8]},{name:"\u05e1\u05e4\u05d8\u05de\u05d1\u05e8",value:[9]},{name:"\u05d0\u05d5\u05e7\u05d8\u05d5\u05d1\u05e8",value:[10]},{name:"\u05e0\u05d5\u05d1\u05de\u05d1\u05e8",value:[11]},{name:"\u05d3\u05e6\u05de\u05d1\u05e8",value:[12]}],this.years=Array.from({length:20},(t,o)=>(new Date).getFullYear()-o),this.onSubmit=new e.vpe,this.oneMonth$=new R.X(!1),this.dateData={}}onCheckboxChange(t){this.oneMonth$.next(t.detail.checked)}saveValue(t,o){switch(o){case"month":this.dateData.month=t.detail.value;break;case"year":this.dateData.year=t.detail.value}}confirm(){this.onSubmit.emit(this.dateData)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sort-date"]],outputs:{onSubmit:"onSubmit"},decls:8,vars:0,consts:[[1,"wrap-form"],[1,"form-sort"],["label","\u05de\u05ea\u05d0\u05e8\u05d9\u05da","fill","outline","label-placement","floating","type","date",1,"input-sort-date"],["label","\u05e2\u05d3 \u05ea\u05d0\u05e8\u05d9\u05da","fill","outline","label-placement","floating","type","date",1,"input-sort-date"],["label","\u05e1\u05e4\u05e7","fill","outline","label-placement","floating","type","text",1,"input-sort-date"],["label","\u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4","fill","outline","label-placement","floating","type","text",1,"input-sort-date"],["type","submit",1,"button-sort"],["size","large","name","search"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e._UZ(2,"ion-input",2)(3,"ion-input",3)(4,"ion-input",4)(5,"ion-input",5),e.TgZ(6,"ion-button",6),e._UZ(7,"ion-icon",7),e.qZA()()())},dependencies:[c.YG,c.gu,c.pK,c.j9,h._Y,h.JL],styles:[".inouts-select[_ngcontent-%COMP%]{display:flex;justify-content:space-between;--padding-top:200px}.checkbox-button[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.input-sort-date[_ngcontent-%COMP%]{flex:1;--border-radius: 15px;margin-right:10px;font-size:90%}.wrap-form[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.form-sort[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;border:2px solid rgb(79,171,79);border-radius:15px;margin:10px;padding:10px}.button-sort[_ngcontent-%COMP%]{--box-shadow: 0;--background: transparent;--color: black;font-weight:bolder;margin:10px;height:50px}@media only screen and (max-width: 640px){.wrap-form[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.form-sort[_ngcontent-%COMP%]{flex-direction:column;margin-bottom:10px;align-items:center}.input-sort-date[_ngcontent-%COMP%]{margin-top:10px;width:100%}}"],changeDetection:0}),n})();function Y(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-table",6),e.NdJ("updateClicked",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.onUpdateClicked(i))})("deleteClicked",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.onDeleteClicked(i))}),e.qZA()()}if(2&n){const t=l.ngIf,o=e.oxw();e.xp6(1),e.Q6J("rows",t)("fieldsNames",o.fieldsNamesToShow)}}const K=[{path:"",component:(()=>{class n{constructor(t,o,i,s){this.loadingController=t,this.http=o,this.expenseDataService=i,this.modalController=s,this.isOnUpdate=!1,this.isToastOpen=!1,this.toastMessage="",this.chooseYear=[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017]}ngOnInit(){this.fieldsNamesToAdd=this.expenseDataService.getAddExpenseColumns(),console.log("this.fieldsNames",this.fieldsNamesToAdd),this.fieldsNamesToShow=this.expenseDataService.getShowExpenseColumns(),console.log("this.fieldsNames",this.fieldsNamesToShow),this.setUserId(),this.setRowsData(),this.expenseDataService.updateTable$.subscribe(t=>{t&&this.setRowsData()})}setUserId(){const t=localStorage.getItem("user"),o=JSON.parse(t);this.uid=o.uid,console.log(this.uid)}setRowsData(){this.items$=this.expenseDataService.getExpenseByUser(this.uid).pipe((0,P.b)(t=>console.log(t))),console.log(this.items$)}openPopupAddExpense(t){console.log("this.fieldsNames in open",this.fieldsNamesToAdd),console.log("data in open",t),(0,f.D)(this.modalController.create({component:D.w,componentProps:{columns:this.fieldsNamesToAdd,editMode:!!Object.keys(t).length,data:t}})).pipe((0,u.K)(o=>(alert("openPopupAddExpense error"),d.E)),(0,x.w)(o=>(0,f.D)(o.present())),(0,u.K)(o=>(alert("openPopupAddExpense switchMap error"),console.log(o),d.E))).subscribe()}onUpdateClicked(t){console.log("in my storage",t),this.openPopupAddExpense(t)}onDeleteClicked(t){const o=localStorage.getItem("token"),i={params:(new v.LE).set("token",o)},s=`${S.N.apiUrl}expenses/delete-expense/`+t;this.getLoader().pipe((0,O.x)(()=>this.loadingController.dismiss()),(0,x.w)(()=>this.http.delete(s,i)),(0,u.K)(r=>(this.toastMessage="\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4 \u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05de\u05d7\u05d5\u05e7 \u05d0\u05ea \u05d4\u05d4\u05d5\u05e6\u05d0\u05d4, \u05d0\u05e0\u05d0 \u05d5\u05d3\u05d0 \u05e9\u05d4\u05d9\u05e0\u05da \u05de\u05d7\u05d5\u05d1\u05e8 \u05dc\u05de\u05e2\u05e8\u05db\u05ea \u05d0\u05d5 \u05e0\u05e1\u05d4 \u05de\u05d0\u05d5\u05d7\u05e8 \u05d9\u05d5\u05ea\u05e8",this.isToastOpen=!0,console.log("The expense cannot be deleted",r),d.E))).subscribe(r=>{console.log("resfrom delete: ",r),this.setRowsData()})}getLoader(){return(0,f.D)(this.loadingController.create({message:"Please wait...",spinner:"crescent"})).pipe((0,u.K)(t=>(console.log("err in create loader in save supplier",t),d.E)),(0,x.w)(t=>t?(0,f.D)(t.present()):(console.log("loader in save supplier is null"),d.E)),(0,u.K)(t=>(console.log("err in open loader in save supplier",t),d.E)))}setOpenToast(){this.isToastOpen=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.HT),e.Y36(v.eN),e.Y36(_.O),e.Y36(c.IN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-my-storage"]],decls:8,vars:7,consts:[[3,"fullscreen"],[1,"div-content"],[1,"div-sort"],["class","table-wrapper",4,"ngIf"],[3,"isOpen","message","duration","didDismiss"],[1,"table-wrapper"],[3,"rows","fieldsNames","updateClicked","deleteClicked"]],template:function(t,o){1&t&&(e._UZ(0,"app-custom-toolbar"),e.TgZ(1,"ion-content",0)(2,"div",1)(3,"div",2),e._UZ(4,"app-sort-date"),e.qZA(),e.YNc(5,Y,2,2,"div",3),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"ion-toast",4),e.NdJ("didDismiss",function(){return o.setOpenToast()}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(4),e.Q6J("ngIf",e.lcZ(6,5,o.items$)),e.xp6(2),e.Q6J("isOpen",o.isToastOpen)("message",o.toastMessage)("duration",3e3))},dependencies:[p.O5,c.W2,c.Px,k.B,z,U,p.Ov],styles:[".div-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.div-sort[_ngcontent-%COMP%]{width:100%}.inputs-sort-date-storage[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;position:absolute;top:62px;width:100%}.inputs-sort-date-storage[_ngcontent-%COMP%]   .filter-box[_ngcontent-%COMP%]{width:100%;display:flex;flex-grow:1;align-items:center;justify-content:space-evenly;border-bottom:2px solid black;margin-right:20px;margin-left:20px;border-color:#000}.inputs-sort-date-storage[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{text-align:end}.inputs-sort-date-storage[_ngcontent-%COMP%]   .labels[_ngcontent-%COMP%]{border:none;padding:10px;background-color:transparent}.inputs-sort-date-storage[_ngcontent-%COMP%]   .month-label[_ngcontent-%COMP%]{padding:10px}.table-wrapper[_ngcontent-%COMP%]{margin:auto;width:95%;height:95%}"]}),n})()}];let L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[y.Bz.forChild(K),y.Bz]}),n})();var $=a(4466);let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.ez,h.u5,c.Pc,L,$.m]}),n})()}}]);